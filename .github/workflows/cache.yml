name: Cache Prime Workflow

on:
  workflow_dispatch:
  push:
    branches: ["main"]

jobs:
  cache_job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # Cache step (must use actions/cache@v4+ and key cache-6c80e18)
      - name: Cache dependencies
        id: cache_deps
        uses: actions/cache@v4
        with:
          path: |
            ~/.cache/pip
            .cache-demo
          key: cache-6c80e18

      # Required step name and must echo hit/miss
      - name: prime-cache-6c80e18
        run: |
          echo "cache-hit=${{ steps.cache_deps.outputs.cache-hit }}"
          if [ "${{ steps.cache_deps.outputs.cache-hit }}" = "true" ]; then
            echo "Cache HIT ✅"
          else
            echo "Cache MISS ❌"
          fi

      # Create something inside cached path so next run becomes a hit
      - name: Create cached artifact
        run: |
          mkdir -p .cache-demo
          date > .cache-demo/primed.txt
          echo "Wrote .cache-demo/primed.txt"
